---
export type FeedbackItem = {
  id: number;
  name: string;
  role: string;
  company: string;
  image: string;
  feedback: string;
};

const feedback: FeedbackItem[] = [
  {
    id: 1,
    name: "John Doe",
    role: "CEO",
    company: "ABC Inc.",
    image: "favicon.svg",
    feedback:
      "Scrumlr makes regular updates, making the tool even more intuitive.",
  },
  {
    id: 2,
    name: "Dohn Joe",
    role: "CFO",
    company: "ABC Inc.",
    image: "favicon.svg",
    feedback: "Amazing tool for planning our agendas in an cooperative way.",
  },
  {
    id: 3,
    name: "Hans Peter",
    role: "CXO",
    company: "ABC Inc.",
    image: "favicon.svg",
    feedback:
      "Our team loved this tool. It made the everything - especially the communication faster and easier üëèüèº",
  },
  {
    id: 4,
    name: "Peter Hans",
    role: "Praktikant",
    company: "ABC Inc.",
    image: "favicon.svg",
    feedback: "This Web-app has so many useful and cool features!",
  },
  {
    id: 5,
    name: "Peter Lusting",
    role: "CTO",
    company: "ABC Inc.",
    image: "favicon.svg",
    feedback: "Gumo zusammen, scruml ist supi",
  },
  {
    id: 6,
    name: "Selina Lusting",
    role: "PO",
    company: "scrumlr Inc.",
    image: "favicon.svg",
    feedback: "Also ich finde scrumlr nicht so cool...",
  },
];
---

<section class="feedback">
  <h2>Our satisfied Users:</h2>
  <p>Happy users are important to us. That's why we value every feedback.</p>
  <div class="feedback_carousel-container">
    {
      Array.from({ length: Math.floor(feedback.length / 4) + 1 }).map(
        (_, index) => (
          <div
            class={`feedback_carousel-item 
                ${index === 0 ? "feedback_carousel-item--active" : ""} 
                feedback_carousel-item--${index}`}
          >
            {feedback.slice(index * 4, index * 4 + 4).map((item) => (
              <div class="feedback_card">
                <p class="feedback_card-text">{item.feedback}</p>
                <div class="feedback_card-author">
                  <img src={item.image} alt={item.name} />
                  <div class="feedback_card-author-info">
                    <h4 class="feedback_card-author-name">{item.name}</h4>
                    <span class="feedback_card-author-position">
                      {item.role}, {item.company}
                    </span>
                  </div>
                </div>
              </div>
            ))}
          </div>
        ),
      )
    }
  </div>
  <div class="feedback-carousel_controls">
    {
      Array.from({ length: Math.floor(feedback.length / 4) + 1 }).map(
        (_, index) => (
          <button
            class={`feedback-carousel_dot ${
              index === 0 ? "feedback-carousel_dot--active" : ""
            } feedback-carousel_dot--${index}`}
          />
        ),
      )
    }
  </div>
</section>

<script>
  const controls = document.getElementsByClassName("feedback-carousel_dot");

  Array.from(controls).forEach((button, index) => {
    button.addEventListener("click", () => {
      document
        .getElementsByClassName("feedback_carousel-item--active")[0]
        ?.classList.remove("feedback_carousel-item--active");
      document
        .getElementsByClassName("feedback-carousel_dot--active")[0]
        ?.classList.remove("feedback-carousel_dot--active");

      document
        .getElementsByClassName(`feedback_carousel-item--${index}`)[0]
        ?.classList.add("feedback_carousel-item--active");
      button.classList.add("feedback-carousel_dot--active");
    });
  });
</script>

<style lang="scss">
  .feedback {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 128px;
  }

  .feedback_carousel-container {
    width: 100%;
    overflow-x: clip;
    margin: 96px;
    display: flex;
    justify-content: center;
  }

  .feedback_carousel-item {
    display: none;
    flex-direction: row;
    animation: fade 0.5s ease-in-out;

    &--active {
      display: flex;
    }
  }

  @keyframes fade {
    from {
      opacity: 0.4;
    }
    to {
      opacity: 1;
    }
  }

  .feedback-carousel_controls {
    justify-content: center;
    display: flex;
    flex-direction: row;
    gap: 24px;
    margin-top: 32px;
  }

  .feedback-carousel_dot {
    all: unset;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background-color: var(--lightmode-pink);
    opacity: 0.5;
    cursor: pointer;

    transition: all 0.2s ease-in-out;

    &--active {
      opacity: 1;
    }

    &:hover {
      opcaity: 0.8;
      transform: scale(1.2);
    }
  }

  .feedback_card {
    width: 333px;
    height: 333px;
    filter: var(--shadow);
    background-color: var(--white);
    border-radius: 16px;
    margin: 0 16px;
    padding: 32px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    box-sizing: border-box;
    position: relative;

    &::before {
      content: "";
      position: absolute;
      top: -1px;
      width: 70px;
      height: 3px;
      background-color: var(--lightmode-pink);
      border-radius: 2px;
    }

    .feedback_card-text {
      margin: 0;
    }

    .feedback_card-author {
      display: flex;
      flex-direction: row;
      gap: 16px;

      img {
        width: 42px;
        height: 42px;
        border-radius: 50%;
      }

      .feedback_card-author-info {
        .feedback_card-author-name {
          margin: 0;
        }
      }
    }
  }
</style>
